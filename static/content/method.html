<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <!-- Meta tags for social media banners, these should be filled in appropriatly as they are your "business card" -->
  <!-- Replace the content tag with appropriate information -->
  <meta name="description" content="WAM is a unifying perspective on feature attribution.">
  <meta property="og:title" content="WAM | Proposed approach"/>
  <meta property="og:description" content="Project page of the Wavelet Attribution Method (ICML 2025)"/>
  <meta property="og:url" content="URL OF THE WEBSITE"/>
  <!-- Path to banner image, should be in the path listed below. Optimal dimenssions are 1200X630-->
  <meta property="og:image" content="../../static/images/wavelet_banner_1200x630.png" />
  <meta property="og:image:width" content="1200"/>
  <meta property="og:image:height" content="630"/>


  <meta name="twitter:title" content="Wavelet attribution method">
  <meta name="twitter:description" content="Project page for the Wavelet Attribution Method (ICML 2025)">
  <!-- Path to banner image, should be in the path listed below. Optimal dimenssions are 1200X600-->
  <meta name="twitter:image" content="../../static/images/your_twitter_banner_image.png">
  <meta name="twitter:card" content="summary_large_image">
  <!-- Keywords for your paper to be indexed by-->
  <meta name="keywords" content="Interpretability, Feature attribution, Wavelet, Images, Audio, 3D, Volumes">
  <meta name="viewport" content="width=device-width, initial-scale=1">


  <title>Wavelet Attribution Method</title>
  <link rel="icon" type="image/x-icon" href="../../static/images/favicon-32x32.png">
  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
  rel="stylesheet">

  <link rel="stylesheet" href="../../static/css/bulma.min.css">
  <link rel="stylesheet" href="../../static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="../../static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="../../static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
  href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="../../static/css/index.css">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://documentcloud.adobe.com/view-sdk/main.js"></script>
  <script defer src="../../static/js/fontawesome.all.min.js"></script>
  <script src="../../static/js/bulma-carousel.min.js"></script>
  <script src="../../static/js/bulma-slider.min.js"></script>
  <script src="../../static/js/index.js"></script>

  <style>
.hero {
  position: relative;
  color: white !important;
}

/* Dark overlay on the background image */
.hero::before {
  content: "";
  position: absolute;
  inset: 0;
  background-color: rgba(0, 0, 0, 0.6); /* Black with 60% opacity */
  z-index: 0;
}

/* Ensure text appears above the overlay */
.hero .hero-body {
  position: relative;
  z-index: 1;
}

/* Titles and subtitles */
.hero .title {
  color: white !important;
}

/* Authors and links */
.hero a {
  color: white !important;
  text-decoration: underline; /* keeps link style */
}

.hero a:hover {
  color: #ddd !important;
}
</style>

<script>
  window.MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      displayMath: [['$$', '$$'], ['\\[', '\\]']]
    }
  };
</script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" defer></script>

</head>
<body>

<section class="hero is-medium" style="background-image: url('../../static/images/wavelet_banner_1200x630.png'); background-size: cover; background-position: center; background-repeat: no-repeat;">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <h1 class="title is-1 publication-title">Feature attribution in the Wavelet domain</h1>
          <div class="column has-text-centered">
            <div class="publication-links">
              <!-- Back to Homepage link -->
              <span class="link-block">
                <a href="../../index.html" 
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                    <i class="fas fa-home"></i>
                  </span>
                  <span>Back to Homepage</span>
                </a>
              </span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>


<!-- Teaser image -->
<section class="section">
  <div class="container is-max-desktop content">
    <h2 class="title is-3">Multiscale decompositions</h2>

<div class="content has-text-justified">
  <p>
      Wavelets decompose signals into components 
      that retain both spatial and frequency information, unlike 
      Fourier transforms, which capture only frequency and discard 
      spatial or temporal context. The choice of the wavelet 
      determines what kind of structural components will be highlighted 
      on the image. Its choice is therefore grounded in the application at hand.
    </p>

    <p>
    A <em>wavelet</em> is a function $\psi \in \mathcal{H} = L^2(\mathbb{R}^n)$ that is normalized,
    centered at the origin, and has zero mean, i.e.,
    $\int_{\mathbb{R}^n} \psi(x) \, dx = 0$. This function $\psi$ is called the
    <em>mother wavelet</em>, and it serves as the building block for constructing
    a family of wavelets via scaling and translation.
  </p>

  <p style="text-align: center;">
    $$\psi_{\lambda,b}(x) = \frac{1}{\lambda^{n/2}} \, \psi\left(\frac{x - b}{\lambda} \right) \tag{1}$$
  </p>

  <p>
    To analyze signals using wavelets, we often discretize the scale and translation
    parameters. A common and efficient choice is to use <em>dyadic scales</em>
    $\lambda = 2^j$ and translations on a dyadic grid $b = 2^j k$,
    where $j, k \in \mathbb{Z}$. This leads to the <strong>Discrete Wavelet Transform</strong> (DWT),
    based on the countable family:
  </p>

  <p style="text-align: center;">
    $$\left\{ \psi_{j,k}(x) = 2^{j n/2}\,
    \psi\!\left(2^{j} x - k \right) \right\}_{j,k \in \mathbb{Z}} \tag{2}$$
  </p>

  <p>
    The DWT represents a signal $g \in L^2(\mathbb{R}^n)$ by projecting it onto this family.
    The wavelet coefficients are obtained as inner products:
  </p>

  <p style="text-align: center;">
    $$\mathcal{W}_{\mathrm{DWT}}(g)(j,k)
    = \langle g, \psi_{j,k} \rangle
    = \int_{\mathbb{R}^{n}} g(x)\,\overline{\psi_{j,k}(x)} \, dx \tag{3}$$
  </p>

  <p>
    These coefficients measure the content of $g$ at scale $2^{-j}$ and location $2^{-j}k$.
    When $\psi$ satisfies certain admissibility and regularity conditions, the DWT
    becomes an invertible transform, and the signal can be exactly reconstructed:
  </p>

  <p style="text-align: center;">
    $$\forall x\in\mathbb{R}^n,\quad g(x) = \sum_{\substack{j \in \mathbb{Z} \\ k \in \mathbb{Z}^n}}
    \langle g, \psi_{j,k} \rangle\psi_{j,k}(x), \tag{4}$$
  </p>
<p>
  where $\mathcal{W}_{\mathrm{DWT}}(g)(j,k)\=\langle g, \psi_{j,k} \rangle$.
</p>
<p>
  The figure below illustrates the process of decomposing an input image into its wavelet components.
</p>
</div>
    

<section class="section"></section>
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <img src="../../static/animations/gif-wavelet-transform.gif" alt="Method Overview"/>
        <br><br>
      </div>
    </div>
    <div class="columns is-centered has-text-centered">
      <b>Computation of the dyadic wavelet transform. </b> A mother wavelet $\psi$ convoluted
      with the original image at different orientations to obtain the horizontal, vertical, and diagonal components at 
      a given scale. The process is repeated for each scale, resulting in a multiscale decomposition of the image.
      </div>
  
  <div class="content has-text-justified">

  Each dyadic wavelet coefficient $\mathcal{W}_{\mathrm{DWT}}(g)(j,k)$ quantifies the presence of 
  features in the signal $g$ at a specific scale $2^{-j}$ and location $2^{-j}k$. Large coefficients 
  indicate that the signal contains structures similar to the mother wavelet $\psi$ at that 
  scale and position. In images, for example, these coefficients can highlight edges, textures, 
  or other localized patterns, depending on the properties of $\psi$.
</p>
<p>
  The multiscale and localized nature of the wavelet transform allows for the 
  analysis of both fine and coarse features, making it especially 
  powerful for signals with hierarchical or spatially varying content.
</p>
<p>
  The selection of the mother wavelet $\psi$ depends 
  on the application.  Haar wavelets are well-suited 
  for detecting sharp discontinuities, while smoother 
  wavelets like Daubechies are better for representing gradual transitions.
</p>
<p>
  In practice, the choice is guided by the characteristics of the data 
  and the goals of the analysis. For image processing, wavelets that are 
  localized in both space and frequency and have directional sensitivity 
  are often preferred. The interpretability and effectiveness 
  of the wavelet decomposition are directly linked to how well 
  the chosen $\psi$ matches the underlying structures in the data.
</p>
</div>
</div>  
</div>
</section>

<!-- Teaser image -->
<section class="section">
  <div class="container is-max-desktop content">
    <h2 class="title is-3">Feature attribution in the wavelet domain</h2>

<div class="content has-text-justified">


<p>
Let $\mathbf{f}$ be a classifier and $\mathbf{x}$ an input signal 
(e.g., an image, an audio, or a volume). The classifier maps the input to a class $c$ via
$$
\mathbf{y}_c = \arg\max_{c \in \mathcal{C}} \mathbf{f}(\mathbf{x}) \equiv \mathbf{f}_c(\mathbf{x}),
$$
with a slight abuse of notation. The original <em>saliency map</em> for class $c$ is defined as:
$$
\gamma_{\text{Sa}}(\mathbf{x}) = \left| \nabla_{\mathbf{x}} \mathbf{f}_c(\mathbf{x}) \right|,
$$
where $\mathbf{f}_c$ is assumed to be piecewise differentiable 
(Simonyan et al., 2014). This map highlights the components 
of the input $\mathbf{x}$ that most influence the classifier's decision, 
based on the gradient's magnitude.
</p>

<p>
Let $\mathbf{z} = \mathcal{W}(\mathbf{x})$ denote the discrete wavelet transform (DWT) 
of $\mathbf{x}$. Since $\mathcal{W}$ is invertible, we can define the saliency map in the wavelet domain as:
</p>

<p style="text-align: center;">
$$
\gamma_{\text{Sa}}(\mathbf{z}) =
\left| \frac{\partial \mathbf{f}_c(\mathbf{x})}{\partial \mathbf{z}} \right|
= \left| \frac{\partial \mathbf{f}_c(\mathbf{x})}{\partial \mathbf{x}} \cdot \frac{\partial \mathcal{W}^{-1}(\mathbf{z})}{\partial \mathbf{z}} \right|,
\tag{1}
$$
</p>

<p>
using the relation $\mathbf{x} = \mathcal{W}^{-1}(\mathbf{z})$ and the chain 
rule. The first term is the gradient of the classifier with respect to the input, 
and the second is the Jacobian of the inverse wavelet transform. 
This wavelet-domain saliency map tells us which coefficients — 
localized in both space and frequency — are most relevant for the prediction.
</p>

<h3 class="title is-4">Smoothing</h3>

<p>
Since $\mathbf{f}_c$ is not necessarily continuously differentiable, 
the raw gradients can vary abruptly, especially at fine scales. 
To address this, we apply a smoothing strategy inspired by 
SmoothGrad (Smilkov et al., 2017), which averages gradients over noisy inputs:
</p>

<p style="text-align: center;">
$$
\gamma_{\text{SG}}(\mathbf{z}) = \frac{1}{n} \sum_{i=1}^{n} \nabla_{\tilde{\mathbf{z}}} \mathbf{f}\left( \mathcal{W}^{-1}(\tilde{\mathbf{z}}) \right),
\tag{2}
$$
</p>

<p>
where $\tilde{\mathbf{z}} = \mathcal{W}(\mathbf{x} + \boldsymbol{\delta})$ and 
$\boldsymbol{\delta} \sim \mathcal{N}(0, \sigma^2 I)$. The number of samples $n$ and 
noise level $\sigma^2$ are tunable hyperparameters. This produces more stable and 
interpretable saliency maps in the wavelet domain. 
</p>

<h3 class="title is-4">Path Integration</h3>

<p>
An alternative to smoothing is to average gradients along a 
continuous path from a baseline input $\mathbf{x}_0$ (typically set to zero) 
to the actual input. This method, known as <em>Integrated Gradients</em> (
  Sundararajan et al., 2017), satisfies desirable theoretical properties 
  like sensitivity and implementation invariance.
</p>

<p>
Adapting this method to the wavelet domain, 
let $\mathbf{z} = \mathcal{W}(\mathbf{x})$ and $\mathbf{z}_0 = \mathcal{W}(\mathbf{x}_0)$, then we define:
</p>

<p style="text-align: center;">
$$
\gamma_{\text{IG}}(\mathbf{z}) = (\mathbf{z} - \mathbf{z}_0) \cdot \int_0^1 
\frac{\partial \mathbf{f}_c\left( \mathcal{W}^{-1}(\mathbf{z}_0 + \alpha(\mathbf{z} - \mathbf{z}_0)) \right)}{\partial \mathbf{z}} \, d\alpha.
\tag{3}
$$
</p>

<p>
This formulation attributes importance to each wavelet coefficient 
by integrating its effect along a straight-line path in the wavelet domain.
</p>


</div>
    

<section class="section"></section>
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <img src="../../static/animations/gif-wavelet-transform.gif" alt="Method Overview"/>
        <br><br>
      </div>
    </div>
    <div class="columns is-centered has-text-centered">
      
      <b>Feature attribution in the wavelet domain.</b> First one computes the wavelet transform 
      of the input signal and requires the gradients with respect to these wavelet coefficients.
      The wavelet transform is then inversed to obtain the original input, which is passed to the model.
      Then, the gradients are computed with respect to the model output. Two averaging methods are 
      proposed in this work: smoothing and path integration. Smoothing emphasizes on the importance 
      of each coefficient within each scale, while path integration highlights the interscale
      dependencies and thus shows that the approximation coefficients are relatively more important
      than the detail coefficients.
      </div>
  
  <div class="content has-text-justified">

</div>
</div>  
</div>
</section>

  </body>
  </html>
